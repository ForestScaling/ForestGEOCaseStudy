// Define the area of interest
var roi = geometry //(/* Provide the coordinates of your area of interest */);


// Function to calculate stand age
//var calculateStandAge = function(geometry) {

var dataset = ee.ImageCollection('USFS/GTAC/LCMS/v2022-8');

var lcms = dataset.filter('study_area == "CONUS"')
          .select('Change')

var fastLossMask = lcms.map(function(image) {
  return image.eq(3);
});


// Replace Fast Loss values with the year of the image
var yearImage = fastLossMask.map(function(image) {
  var year = ee.Number.parse(ee.String(image.get('system:index')).slice(-4));
  return image.multiply(year).int();

});

// Combine the collection into a single image with the most recent value (max)
var maxChangeImage = yearImage.max();
var mask = maxChangeImage.eq(0)
var mask = mask.not();
var standAge = maxChangeImage.mask(mask)
var standAge = ee.Image(2022).subtract(standAge)

print(maxChangeImage)

var yodVizParms = {
  min: 0,
  max: 38,
  palette: ['#9400D3', '#4B0082', '#0000FF', '#00FF00', '#FFFF00', '#FF7F00', '#FF0000']
};
print(standAge)
//var boosttree = boosttree.select(['b1'],['constant'])

//YOU NEED TO ADD A SLIDING NUMBER THAT ALLOWS THE RASTER TO GROW AS THE YEARS GO ON
var standagearcgis =  standagearcgis.select("b1").rename('constant').int()
print(standagearcgis)
var combined_img = ee.ImageCollection([standAge.int(), standagearcgis]).min();
// Load or import the Hansen et al. forest change dataset.
var hansenImage = ee.Image('UMD/hansen/global_forest_change_2015');

// Select the land/water mask.
var datamask = hansenImage.select('datamask');

// Create a binary mask.
var mask = datamask.eq(1);

// Update the composite mask with the water mask.
var combined_img = combined_img.updateMask(mask);
var modis = modis.select('LC_Prop2')
var modis = modis.first().mask(combined_img)
var modismask = modis.eq(20).or(modis.eq(10))

var final_image = combined_img.mask(modismask);

Map.addLayer(final_image, yodVizParms, "Year")
//};
